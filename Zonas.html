<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png" />
  <link rel="shortcut icon" href="favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="192x192" href="android-chrome-192x192.png" />
  <link rel="icon" type="image/png" sizes="512x512" href="android-chrome-512x512.png" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700;800&display=swap" rel="stylesheet">
  <title>Mapa de Zonas</title>
  <style>
    body{
      font-family:"Lato",system-ui,Segoe UI,Roboto,Arial,sans-serif;
      margin:0;
      background:#fff url("zonas.webp") center/cover no-repeat fixed;
      color:#1f2937;
    }
    a { color: inherit; text-decoration: none; }
    .container{max-width:1180px;margin:0 auto;padding:0 20px}
    header {
      position: sticky;
      top: 0;
      z-index: 60;
      padding: 10px 0;
      background: linear-gradient(180deg, rgba(10, 21, 56, .78), rgba(10, 21, 56, .55));
      border-bottom: 1px solid rgba(255,255,255,.10);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      box-shadow: 0 8px 24px rgba(0,0,0,.18);
    }
    .topbar {display:flex;align-items:center;justify-content:center;position:relative;min-height:44px}
    .brandLogo {
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      padding: 8px 16px;
      border-radius: 999px;
      background: linear-gradient(135deg, rgba(255,255,255,.28), rgba(255,255,255,.38));
      border: 1px solid rgba(255,255,255,.46);
      box-shadow: 0 18px 36px rgba(0,0,0,.28);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }
    .brandLogo img { height: 44px; width: auto; display: block; }
    .navlinks {
      display: flex;
      gap: 10px;
      padding: 6px;
      border-radius: 999px;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.10);
      box-shadow: 0 10px 26px rgba(0,0,0,.18);
    }
    .navlinks a {
      padding: 10px 16px;
      border-radius: 999px;
      font-weight: 800;
      color: rgba(226,232,240,.95);
      letter-spacing: -0.01em;
      transition: background 0.15s ease, transform 0.15s ease, color 0.15s ease;
    }
    .navlinks a:hover {
      background: rgba(255,255,255,.12);
      transform: translateY(-1px);
      color: rgba(255,255,255,.98);
    }
    .navlinks a[aria-current="page"] {
      background: rgba(255,255,255,.16);
      color: #ffffff;
    }

    main{padding:16px 0 28px}
    .layout{display:grid;grid-template-columns:1fr 340px;gap:16px;align-items:start}
    .card{
      border:1px solid rgba(255,255,255,.2);
      border-radius:16px;
      padding:14px;
      background: rgba(0,0,0,.48);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      box-shadow: 0 16px 34px rgba(0,0,0,.25);
      color: #f8fafc;
    }
    #mapWrap{position:relative}
    svg{width:100%;height:auto;max-height:86vh}
    .zone{cursor:pointer;transition:fill .2s ease,opacity .15s}
    .tooltip{
      position:absolute;display:none;pointer-events:none;
      background:#111;color:#fff;padding:10px 12px;border-radius:12px;
      font-size:13px;gap:10px;align-items:center
    }
    .tooltip img{width:34px;height:34px;border-radius:50%;object-fit:cover;background:#333}
    .pill{display:inline-block;background:rgba(255,255,255,.2);border:1px solid rgba(255,255,255,.28);border-radius:999px;padding:6px 10px;font-size:12px;color:#fff}
    .panelSection + .panelSection{margin-top:12px}
    #panel img{width:96px;height:96px;border-radius:18px;object-fit:cover;background:#f3f4f6}
    .companyLogo{width:150px;height:auto !important;border-radius:12px !important;padding:6px;background:#fff}
    .companyData{margin:10px 0;color:rgba(248,250,252,.88);line-height:1.5}
    .companyData p{margin:0 0 6px}
    .companyData a{color:#fff;text-decoration:underline}
    button{width:100%;padding:10px 12px;border-radius:12px;border:0;background:#111;color:#fff;cursor:pointer}
    button:disabled{opacity:.4;cursor:not-allowed}


    @media (max-width: 960px){
      .layout{grid-template-columns:1fr}
      .topbar{justify-content:flex-end}
      .brandLogo{position:static;transform:none;margin-right:auto}
      .navlinks{gap:6px;padding:5px}
      .navlinks a{padding:8px 12px;font-size:14px}
    }
  </style>
</head>
<body>
  <header>
    <div class="container topbar">
      <a class="brandLogo" href="index.html" aria-label="AgriCheck inicio">
        <img src="agrichecklogo.png" alt="AgriCheck" />
      </a>
      <nav class="navlinks" aria-label="Navegación principal">
        <a href="index.html">Inicio</a>
        <a href="nuestros-productos.html">Nuestros productos</a>
        <a href="Zonas.html" aria-current="page">Zonas</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <div class="layout">
      <div id="mapWrap" class="card">
        <div class="pill">Zonas comerciales</div>

      <div id="mapContainer" aria-label="Mapa de zonas"></div>

      <div id="tt" class="tooltip">
        <img id="ttImg" alt="">
        <div>
          <div id="ttName" style="font-weight:700"></div>
          <div id="ttMeta" style="opacity:.85;font-size:12px"></div>
        </div>
      </div>
    </div>

      <aside id="panel" class="card">
        <div class="pill">Detalle</div>

        <div id="defaultPanel" class="panelSection">
          <h2 style="margin:10px 0 6px">AgriCheck SRL</h2>
          <img class="companyLogo" src="agrichecklogo.png" alt="Logo AgriCheck">
          <div class="companyData">
            <p><strong>Agroinsumos especiales</strong></p>
            <p>San Juan 50, General Roca, Argentina</p>
            <p><strong>Email:</strong> <a href="mailto:info@agrichecksrl.com">info@agrichecksrl.com</a></p>
            <p><strong>WhatsApp:</strong> <a href="tel:+5492984763055">+54 9 2984 76-3055</a></p>
          </div>
          <button id="defaultWa">Enviar WhatsApp</button>
        </div>

        <div id="sellerPanel" class="panelSection" hidden>
          <h2 id="pName" style="margin:10px 0 6px">Seleccioná una zona</h2>
          <img id="pImg" alt="">
          <p id="pMeta" style="color:rgba(248,250,252,.88);margin:10px 0 6px"></p>
          <p id="pPhone" style="margin:0 0 12px;color:#fff"></p>
          <button id="pWa" disabled>Enviar WhatsApp</button>
        </div>
      </aside>
    </div>
  </main>

<script>
  // ✅ Datos (editá a gusto). Se comparan con el title/id del SVG usando normalización flexible.
  const sellers = {
    "Marcelo Lizondo": { color:"#2F8F99", img:"marcelo.jpg", phone:"5491111111111", meta:"Zona Norte" },
    "Alan Schmidt":    { color:"#00ACC1", img:"agrichecklogo.png", phone:"",              meta:"Zona Los Umas" },
    "Miguel Utrera":   { color:"#3AA6B9", img:"Miguel.webp", phone:"5492222222222", meta:"Zona Centro" },
    "Evelyn Rivero-Daiana Gonzalez": { color:"#2E7D32", img:"Diana.webp", phone:"5493333333333", meta:"Zona Oeste" },
    "Andres Perez":    { color:"#1B5E20", img:"Andres.jpg",  phone:"5494444444444", meta:"Zona Sur" },
    "Victoria Vianna": { color:"#FB8C00", img:"victoria.jpg",phone:"5495555555555", meta:"Zona Andina" },
    "Anibal Epullan":  { color:"#FDD835", img:"anibal.jpg",  phone:"5496666666666", meta:"Zona Patagonia" }
  };

  const tt = document.getElementById("tt");
  const ttImg = document.getElementById("ttImg");
  const ttName = document.getElementById("ttName");
  const ttMeta = document.getElementById("ttMeta");

  const pName = document.getElementById("pName");
  const pImg = document.getElementById("pImg");
  const pMeta = document.getElementById("pMeta");
  const pPhone = document.getElementById("pPhone");
  const pWa = document.getElementById("pWa");
  const defaultPanel = document.getElementById("defaultPanel");
  const sellerPanel = document.getElementById("sellerPanel");
  const defaultWa = document.getElementById("defaultWa");

  const companyWhatsapp = "5492984763055";

  function normalizeZoneName(value){
    return (value || "")
      .normalize("NFD")
      .replace(/[\u0300-\u036f]/g, "")
      .toLowerCase()
      .replace(/[^a-z0-9]+/g, " ")
      .trim();
  }

  const sellersNormalized = Object.fromEntries(
    Object.entries(sellers).map(([name, data]) => [normalizeZoneName(name), { name, ...data }])
  );

  const sellersByZoneId = {
    zona1: "Marcelo Lizondo",
    zona2: "Alan Schmidt",
    zona3: "Miguel Utrera",
    zona4: "Evelyn Rivero-Daiana Gonzalez",
    zona5: "Andres Perez",
    zona6: "Victoria Vianna",
    zona7: "Anibal Epullan"
  };

  function resolveSeller(rawName, zoneId){
    const byName = sellersNormalized[normalizeZoneName(rawName)];
    if(byName) return byName;
    const mappedName = sellersByZoneId[zoneId];
    return mappedName ? { name: mappedName, ...sellers[mappedName] } : null;
  }

  defaultWa.addEventListener("click", () => {
    const msg = encodeURIComponent("Hola AgriCheck, quiero hacer una consulta.");
    window.open(`https://wa.me/${companyWhatsapp}?text=${msg}`, "_blank");
  });

  function moveTooltip(e){
    const rect = document.getElementById("mapWrap").getBoundingClientRect();
    tt.style.left = (e.clientX - rect.left + 12) + "px";
    tt.style.top  = (e.clientY - rect.top + 12) + "px";
  }

  function openPanel(zoneName, zoneId){
    const resolved = resolveSeller(zoneName, zoneId);
    const s = resolved;
    if(!s) return;
    defaultPanel.hidden = true;
    sellerPanel.hidden = false;
    pName.textContent = resolved.name;
    pImg.src = s.img;
    pMeta.textContent = s.meta || "";
    pPhone.textContent = s.phone ? ("+" + s.phone) : "";
    pWa.disabled = !s.phone;
    pWa.onclick = () => {
      const msg = encodeURIComponent(`Hola ${resolved.name}, te contacto por tu zona.`);
      window.open(`https://wa.me/${s.phone}?text=${msg}`, "_blank");
    };
  }

  async function loadMap(){
    const mapContainer = document.getElementById("mapContainer");
    const response = await fetch("./argentina-zonas.svg");
    if(!response.ok) throw new Error("No se pudo cargar el mapa SVG");

    const svgText = await response.text();
    mapContainer.innerHTML = svgText;

    mapContainer.querySelectorAll("path[title], polygon[title]").forEach(zone => {
      zone.classList.add("zone");
      zone.dataset.zone = zone.getAttribute("title")?.trim() || "";
      zone.dataset.zoneId = zone.getAttribute("id")?.trim() || "";
    });
  }

  // ✅ Inicializar zonas (se ejecuta cuando el SVG está en el DOM)
  function initZones(){
    const zones = document.querySelectorAll(".zone");
    const baseZoneFill = "rgba(255, 232, 140, 0.45)";
    const hoverZoneFill = "rgba(255, 241, 186, 0.62)";
    const zoneStroke = "#ffe7a3";

    zones.forEach(z => {
      const name = (z.dataset.zone || "").trim();
      const zoneId = (z.dataset.zoneId || "").trim();
      const resolved = resolveSeller(name, zoneId);
      const s = resolved;
      z.style.fill = baseZoneFill;
      z.style.stroke = zoneStroke;
      z.style.strokeWidth = "2";

      z.addEventListener("mouseenter", (e)=>{
        z.style.fill = hoverZoneFill;
        ttName.textContent = resolved?.name || name || "Zona sin asignar";
        ttMeta.textContent = s?.meta ?? "Sin datos";
        ttImg.src = s?.img ?? "";
        tt.style.display = "flex";
        moveTooltip(e);
      });
      z.addEventListener("mousemove", moveTooltip);
      z.addEventListener("mouseleave", ()=> {
        z.style.fill = baseZoneFill;
        tt.style.display = "none";
      });
      z.addEventListener("click", ()=> openPanel(name, zoneId));
    });
  }

  window.addEventListener("load", async () => {
    try {
      await loadMap();
      initZones();
    } catch (error) {
      document.getElementById("mapContainer").innerHTML = "<p>No se pudo cargar el mapa.</p>";
      console.error(error);
    }
  });
</script>
</body>
</html>
